# 从电影《解密》，聊一聊现代密码学

上个周末，我在网上观看了电影《解密》。这部电影改编自麦家同名小说，是其谍战三部曲中的一部。影片给我最深刻的印象之一是主角刘昊然的表现，他完全摒弃了偶像形象，成功塑造了一个沉迷于解密、专注到忘我的天才疯子形象。刘昊然把角色的木讷、偏执和执着演绎得淋漓尽致，令人感到震撼。

电影的背景设定在四十年代到六十年代，那个时期电子计算机已被发明，现代密码学也悄然诞生。在影片中，几次出现了图灵机的画面，不禁让人产生疑问：最后一次解密的黑密，是否是梦境中的幻觉？因为根据影片展现的古典解密方法，破解现代密码几乎是不可能的。

影片中的容金珍灵感的来源之一是他的梦境。通过梦中的符号和场景，如摩天轮、旋转木马等，他联想到密码的结构和解密方法。换句话说，古典的解密方法侧重于找到密码中的规律和模式，关键在于解密手段。然而，进入现代密码学的领域后，加密算法和解密算法本身已经是公开的，真正的难点在于如何保护密钥的机密性。

现代密码算法的设计经过严格的数学证明，确保了其安全性和可靠性。随着计算机的诞生，现代密码学的计算复杂度大幅提升，依靠仅仅明文和密文的信息，几乎无法发现密码的规律。即使截获了大量的密电，现代密码也依然无法被破解。

电影中的解密过程显示，容金珍曾怀疑美国人可能采用了更高级的计算工具，传统的破解方法根本行不通。当然，为了符合影片的节奏和观众的期望，最终给出了一个皆大欢喜的结局。

既然现代密码学的核心在于保护密钥的安全，那么一旦密钥被缴获，是不是就能轻松破解密码呢？这就像谍战片中常见的情节，缴获敌人的密码本或密码机后，事情就迎刃而解。但现实并非如此简单。

密钥本质上是一个随机数，且更新成本低廉。与发明一种全新的加密算法相比，生成新的密钥并通知通信双方的成本要低得多。实际上，加密算法的革新需要大量的时间和精力，而更换密钥的工作却可以迅速完成。

随着非对称加密技术的诞生，密钥分发问题也得到了有效解决。非对称加密使用一对密钥——公钥和私钥。公钥可以公开，用于加密数据，而私钥则保持保密，用于解密。即使截获了公钥，攻击者也无法破解加密的数据。

不过，非对称加密算法运算较慢，通常不用于大规模数据加密。加密大量数据时，通常采用对称加解密算法。那么，密钥分发的问题是否依然存在呢？

事实上，这一问题也通过非对称加密算法衍生出的密钥交换协议，如Diffie-Hellman算法，得到了有效解决。通过密钥交换，双方可以协商出一个共同的密钥，且只有双方知晓。即便第三方截获了密钥交换的过程，也无法得知实际的密钥。而且每次通信时都会生成新的密钥，这样即使截取了大量报文，依然无法破解其中的内容。

在电影中，解密工作并非容金珍一人独立完成，而是由一个团队共同协作。许多人使用算盘和计算尺等工具辅助运算。然而，这些算力在现代计算机面前，几乎显得微不足道。

那么，现代密码学如此严密，真的没有破解的办法吗？答案是有的，但破解的关键并不是针对加密算法本身，而是针对密钥。

首先，攻击者可以利用人性的弱点。虽然密钥本质上是一个庞大的随机数，但人类很难记住这种随机数。因此，大多数人选择使用简单的口令来生成密钥。为了方便记忆，很多人会选择一些简单的单词或数字，例如使用最常见的密码“123456”。这就为攻击者提供了漏洞，一方面可以通过猜测密码，另一方面可以通过暴力破解穷举密码字典。因为加解密算法是公开的，只要穷举出所有可能的密码，就能找到正确的密钥。

其次，程序员在编写代码时也可能留下漏洞。为了调试方便，程序员可能会留下调试信息，或将密钥硬编码在程序中。更糟糕的是，有些企业甚至将用户密码以明文形式保存在数据库中。这种问题在一些大公司中屡见不鲜，只需搜索一下新闻，就能找到许多相关案例。

最后，还有一种常见的攻击方式是撞库攻击。例如，攻击者如果截获了某个网站的数据库，就可能尝试用其中的密码去登录其他网站，因为许多用户往往会在多个网站上使用相同的密码，成功率因此大大提高。

当然，现代密码学面临的最大挑战之一来自量子计算机。量子计算机不同于传统的经典计算机，它利用量子比特（qubit）的叠加和纠缠特性，可以在某些特定类型的问题上实现远超传统计算机的计算能力。量子计算机的并行计算能力使其能够同时处理大量的信息，这使得其在破解现代密码学中的加密算法时，具有巨大的潜力。尤其是在对称加密和非对称加密算法中，量子计算机可能通过量子算法如Shor算法，能够在短时间内破解经典计算机几乎无法攻破的密钥，极大地缩短暴力破解的时间。

以比特币的加密算法为例，传统计算机通过穷举法暴力破解加密的复杂度非常高，而量子计算机的出现可能使得破解这些加密的工作变得轻而易举。《AI未来》一书中提到，量子计算机能迅速突破比特币的加密算法，甚至能够通过破解获得大量的比特币财富。这一前景让很多加密货币和网络安全领域的专家感到担忧，因为一旦量子计算机成熟，现有的密码体系可能瞬间不堪一击，带来巨大的安全风险。

然而，目前量子计算机仍然处于研发阶段，距离真正能够进行大规模商用还有很长的路要走。虽然全球范围内的科研团队和企业都在积极投入量子计算的研究，但目前的量子计算机还只能解决一些小规模、特定领域的问题，离可以普遍应用于破解现实中的密码系统仍有很大的技术难题待解决。量子计算机的稳定性、计算能力以及错误率等问题仍然是亟待克服的瓶颈。

与此同时，随着量子计算威胁的逐渐浮现，密码学界也在积极应对，开发抗量子计算的加密算法，通称为“抗量子密码学”（post-quantum cryptography）。这些新的算法设计理念将基于量子计算机无法轻易破解的数学问题，如格理论（lattice-based cryptography）、编码理论（code-based cryptography）等，从而确保在量子计算机到来之前，现有的加密通信和数据保护体系能保持安全。尽管这些新算法仍在研究和标准化过程中，但它们提供了应对量子计算威胁的希望，并可能成为未来密码学的基础。

因此，尽管量子计算机为现代密码学带来了巨大的挑战，但随着技术的不断进步和新的加密算法的出现，形势也许并不像一些人所预想的那么糟糕。量子计算的威胁并不是不可克服的，而是迫使密码学家们不断创新和完善现有的安全防线，推动密码学的持续发展。

电影《解密》通过精彩的剧情和丰富的视觉效果，展示了密码学在历史上的重要地位及解密过程的复杂性。然而，影片中展现的解密方法与现代密码学有着显著的差异，尤其是在面对量子计算机这一全新威胁时，传统的加密技术显得力不从心。这也揭示了现代密码学在实际应用中的巨大进步，它不仅依赖于传统的数学理论，还不断融合新兴技术以应对未来的挑战。因此，虽然电影中的解密方法充满魅力，但它也反映了历史与现实之间的巨大差距，提醒我们密码学领域正在经历一场技术革命，面对着来自量子计算等前沿领域的挑战。
